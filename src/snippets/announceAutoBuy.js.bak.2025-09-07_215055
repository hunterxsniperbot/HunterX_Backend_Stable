// === HunterX â€” announceAutoBuy (COMPRA) ===
// Formato EXACTO pedido (HTML), con botones PnL y 25/50/75/100.
function announceAutoBuy(bot, uid, info) {
  try {
    const chatId   = (bot._notifyChatByUid && bot._notifyChatByUid[uid]) ? bot._notifyChatByUid[uid] : Number(uid);
    const t        = info.trade || {};
    const tradeId  = String(t.id || t.tradeId || ("demo-" + Date.now()));
    const sym      = String(info.symbol || t.token || "â€”").trim();
    const mint     = String(t.mint || "So11111111111111111111111111111111111111112");
    const mintShort= mint.slice(0,6) + "â€¦";

    const sizeUsd  = Number(info.size ?? t.amountUsd ?? 0);
    const sizeSol  = (t.sizeSol!=null) ? Number(t.sizeSol) : 0;
    const entryUsd = (t.priceUsd!=null) ? Number(t.priceUsd) : 200.0000; // placeholder ok
    const route    = t.route || "Raydium";
    const slipBps  = (t.slippageBps!=null) ? Number(t.slippageBps) : 50;
    const feesUsd  = (t.feesUsd!=null) ? Number(t.feesUsd) : 0.01;

    const buyScore  = (t.buyScorePct!=null)  ? (Number(t.buyScorePct).toFixed(0)+"%") : "â€”";
    const scamScore = (t.scamScorePct!=null) ? (Number(t.scamScorePct).toFixed(0)+"%") : "â€”";
    const T1        = (t.T1!=null) ? String(t.T1) : "â€”";
    const scamT1    = (t.scam_t1!=null) ? String(t.scam_t1) : "â€”";

    const ts = new Date().toLocaleString();

    // === Texto EXACTO (HTML) ===
    const html = [
      "âœ… <b>COMPRA AUTOMÃTICA EJECUTADA </b>",
      "ğŸ§¾ <b>Trade ID:</b> #"+tradeId,
      "ğŸª™ <b>Token:</b> $"+sym+" ("+mintShort+")",
      "ğŸ”— <b>Ruta:</b> "+route+" â€¢ <b>Slippage:</b> "+slipBps+" bps â€¢ <b>Fees/Gas:</b> ~"+feesUsd,
      "ğŸ’µ <b>Invertido:</b> "+sizeUsd.toFixed(2)+" USD ("+sizeSol.toFixed(6)+" SOL) ğŸ¯ <b>Entrada:</b> "+entryUsd.toFixed(4)+" USD",
      "ğŸ“Š <b>buy_score:</b> "+buyScore+" (T1 "+T1+") â€¢ <b>scam_score:</b> "+scamScore+" (scam_t1 "+scamT1+")",
      "ğŸ›¡ï¸<b>Guardas:</b>",
      "- Honeypot âœ…",
      "â€¢ LiqLocked ğŸ”’",
      "â€¢ Renounced ğŸ—ï¸",
      "â€¢ Stale âœ…",
      "ğŸ“ˆ <b>TP/SL:</b> TP â€” â€¢ SL â€” â€¢ <b>Cooldown:</b> â€” s",
      "â±ï¸ <b>Hora:</b> "+ts,
      "<b>Enlaces rÃ¡pidos</b> <a href=\"https://dexscreener.com/solana\">DexScreener</a> | <a href=\"https://jup.ag/swap/SOL-USDC\">Jupiter</a> | <a href=\"https://raydium.io/swap/?from=SOL&to=USDC\">Raydium</a> | <a href=\"https://birdeye.so/token/SOL?chain=solana\">Birdeye</a> | <a href=\"https://solscan.io/token/"+mint+"\">Solscan</a> Con los botones de pnl para actualizarlos cuando quiera y bonores de venta parcial 25 50 75 100"
    ].join("\n");

    const kb = {
      inline_keyboard: [
        [{ text: "ğŸ“Š PnL", callback_data: "HX_PNL:"+tradeId }],
        [
          { text: "ğŸ” 25%", callback_data: "HX_SELL:"+tradeId+":25" },
          { text: "ğŸ” 50%", callback_data: "HX_SELL:"+tradeId+":50" },
          { text: "ğŸ” 75%", callback_data: "HX_SELL:"+tradeId+":75" },
          { text: "ğŸ’¯ 100%", callback_data: "HX_SELL:"+tradeId+":100" }
        ]
      ]
    };

    bot.sendMessage(chatId, html, { parse_mode: "HTML", disable_web_page_preview: true, reply_markup: kb }).catch(()=>{});
  } catch(_) {}
}
