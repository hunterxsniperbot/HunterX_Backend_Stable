# 8-09-2025 14:18 ‚Äî Checkpoint DEMO inline sell + PnL in-place

## Qu√© qued√≥
- **Tarjeta √∫nica** de compra (formato pedido) con **botones inline** [üìä, 25/50/75/100].
- **Ventas parciales** DEMO con *clamp* de remanente (no permite >100%) y aviso de ‚Äúremanente X%‚Äù.
- **üìä PnL in-place**: el bot√≥n refresca precio (Jupiter price API ‚Üí fallback a precio de entrada) y
  **edita la misma card** manteniendo botones.
- **Mapeos en memoria**:
  - `_hxMsgByKey[uid:tradeId]` ‚Üí `{ chatId, message_id }` para poder editar.
  - `_hxTradeInfo[uid:tradeId]` ‚Üí `{ symbol, mint, amountUsd, entryUsd, htmlBase }`.
- **Silenciado** el mensaje legacy de `/demo_buy` (no duplica tarjetas).
- **Handlers normalizados** en `index.js`:
  - `inlinePnlSell` 1 sola vez.
  - `demo_cmds` para `/demo_reset` y `/demo_buy`.
- **Links reales** por defecto para SOL (Birdeye/Solscan con mint de SOL).

## Lo conocido / pendiente
- Log de M4: `NO-BUY detail: r is not defined` (cosm√©tico); parchear `m4Selector` o hacer guard.
- **Links token espec√≠ficos**: cuando tengamos `mint/pair` desde el selector, reemplazar en la card.
- **Auto-refresh** de PnL cada X s (opcional) mientras haya posici√≥n abierta.
- Modo REAL: confirmar 100% con Phantom/Jupiter, y sincronizar `/wallet` y registro on-chain.

## Archivos tocados (clave)
- `src/commands/demo_cmds.js` (nuevo): announce + teclado + comandos demo.
- `src/bot/inlinePnlSell.js`: callbacks de üìä y ventas con edici√≥n in-place.
- `index.js`: registro de handlers, una sola vez.
